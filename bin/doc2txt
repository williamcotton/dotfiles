#!/usr/bin/env python

import sys
import pypandoc
import subprocess
import pdftotext
import pandas as pd

def docx_to_text(file_path):
    output = pypandoc.convert_file(file_path, 'plain', format='docx')
    return output

def pdf_to_text(file_path):
    output = subprocess.check_output(['pdftotext', '-layout', file_path, '-'])
    text = output.decode('utf-8')

    if len(text) > 0:
        return text

    with open(file_path, "rb") as f:
        pdf = pdftotext.PDF(f)

    return "\n\n".join(pdf)

def xls_to_text(file_path):
    df = pd.read_excel(file_path)
    return df.to_string()

def pptx_to_text(file_path):
    output = pypandoc.convert_file(file_path, 'plain', format='pptx')
    return output

def bin_to_text(file_path):
    with open(file_path, 'rb') as f:
        return f.read()

def rtf_to_text(file_path):
    output = pypandoc.convert_file(file_path, 'plain', format='rtf')
    return output

if __name__ == "__main__":
    # Check if a file path is provided
    if len(sys.argv) != 2:
        print("Usage: python script.py <file_path>")
        sys.exit(1)

    # Get the file path from the command line argument
    file_path = sys.argv[1]

    # Determine the file type and convert the document to plain text
    if file_path.endswith('.doc') or file_path.endswith('.docx'):
        print(docx_to_text(file_path))
    elif file_path.endswith('.pdf'):
        print(pdf_to_text(file_path))
    elif file_path.endswith('.xls'):
        print(xls_to_text(file_path))
    elif file_path.endswith('.pptx'):
        print(pptx_to_text(file_path))
    elif file_path.endswith('.bin'):
        print(bin_to_text(file_path))
    elif file_path.endswith('.rtf'):
        print(rtf_to_text(file_path))
    else:
        print("Unsupported file type")